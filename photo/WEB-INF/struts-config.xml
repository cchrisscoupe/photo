<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">

<struts-config>

  <form-beans>

		<form-bean name="loginForm"
			type="org.apache.struts.validator.DynaValidatorForm">
			<form-property name="username" type="java.lang.String"/>
			<form-property initial="" name="password" type="java.lang.String"/>
			<form-property initial="false" name="admin" type="java.lang.Boolean"/>
		</form-bean>

		<form-bean name="adminifyForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="action" type="java.lang.String"/>
		</form-bean>

   <form-bean name="displayForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="id" type="java.lang.Integer"/>
			<form-property name="search_id" type="java.lang.Integer"/>
			<form-property name="image_id" type="java.lang.Integer"/>
		</form-bean>

    <form-bean name="searchForm" type="net.spy.photo.struts.SearchForm"/>

   <form-bean name="cursorForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="startOffset" type="java.lang.Integer"/>
			<form-property name="whichCursor" type="java.lang.String"/>
		</form-bean>

    <form-bean name="uploadForm" type="net.spy.photo.struts.UploadForm"/>

    <form-bean name="saveSearchForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="name" type="java.lang.String"/>
			<form-property name="search" type="java.lang.String"/>
		</form-bean>

    <form-bean name="newUserForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="username" type="java.lang.String"/>
			<form-property name="password" type="java.lang.String"/>
			<form-property name="pass2" type="java.lang.String"/>
			<form-property name="realname" type="java.lang.String"/>
			<form-property name="email" type="java.lang.String"/>
			<form-property name="profile" type="java.lang.String"/>
		</form-bean>

    <form-bean name="setSizeForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="dims" type="java.lang.String"/>
		</form-bean>

    <form-bean name="changePWForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="oldpw" type="java.lang.String"/>
			<form-property name="newpw1" type="java.lang.String"/>
			<form-property name="newpw2" type="java.lang.String"/>
		</form-bean>

    <form-bean name="forgotPWForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="username" type="java.lang.String"/>
		</form-bean>

    <form-bean name="commentForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="imageId" type="java.lang.Integer"/>
			<form-property name="comment" type="java.lang.String"/>
		</form-bean>

    <form-bean name="addToGalleryForm"
			type="org.apache.struts.validator.DynaValidatorForm">

			<form-property name="id" type="java.lang.Integer"/>
		</form-bean>

    <form-bean name="saveGalleryForm"
			type="net.spy.photo.struts.SaveGalleryForm"/>
    <form-bean name="emptyForm"
			type="net.spy.photo.struts.EmptyForm"/>

		<!-- Admin beans -->
		<form-bean name="adminUserForm" type="net.spy.photo.struts.AdminUserForm"/>
		<form-bean name="adminCatForm"
			type="net.spy.photo.struts.AdminCategoryForm"/>
		<form-bean name="adminNewProfileForm"
			type="net.spy.photo.struts.AdminNewProfileForm"/>
  </form-beans>

  <action-mappings>

	<!-- Login -->
	<action    path="/login"
		type="net.spy.photo.struts.LoginAction"
		input="/credform.jsp"
		scope="request"
		name="loginForm">
		<forward name="success" path="/index.jsp" />
		<forward name="setadmin" path="/adminify.do?action=setadmin" />
	</action>

	<!-- Logout -->
	<action    path="/logout"
		type="net.spy.photo.struts.LogoutAction">
		<forward name="success" path="/index.jsp" />
	</action>

	<!-- How to handle displays -->
	<action
		path="/display"
		name="displayForm"
		scope="request"
		type="net.spy.photo.struts.GetImageDataAction">
		<forward name="next" path="/displaySwitch.do"/>
	</action>

	<action path="/displaySwitch" type="net.spy.photo.struts.AdminSwitchAction">
		<forward name="subadmin" path="/admin/display.jsp"/>
		<forward name="noadmin" path="/display.jsp"/>
	</action>

	<action path="/refreshDisplay" type="net.spy.photo.struts.SetDisplayRefresh">
		<forward name="success" path="/display.jsp"/>
	</action>

	<!-- Change password -->
	<action    path="/changepw"
		type="net.spy.photo.struts.ChangePWAction"
		input="/changepw.jsp"
		scope="request"
		name="changePWForm">
		<forward name="success" path="/index.jsp" />
	</action>

	<!-- Forgot password -->
	<action    path="/forgotpw"
		type="net.spy.photo.struts.ForgotPWAction"
		input="/credform.jsp"
		scope="request"
		name="forgotPWForm">
		<forward name="success" path="/forgotpw_out.jsp" />
	</action>

  <!-- Add a new comment -->
  <action path="/addcomment"
    type="net.spy.photo.struts.CommentAction"
    input="/commentinput.jsp"
    name="commentForm">
		<forward name="success" path="/display.do" />
  </action>

	<!-- Enable/disable administrative access. -->
	<action path="/adminify"
		type="net.spy.photo.struts.AdminifyAction"
		scope="request"
		name="adminifyForm">
		<forward name="success" path="/index.jsp"/>
	</action>

	<!-- Set the optimal image size. -->
	<action path="/setviewsize"
		type="net.spy.photo.struts.SetSizeAction"
		input="/sizeform.jsp"
		scope="request"
		name="setSizeForm">
		<forward name="success" path="/index.jsp"/>
	</action>

	<!-- Searches -->
	<action    path="/search"
		type="net.spy.photo.struts.SearchAction"
		input="/search.jsp"
		name="searchForm">
		<forward name="success" path="/filterSearch.do" />
		<forward name="showResults" path="/filterSearch.do" />
	</action>

	<!-- Search result cursor movement -->
	<action    path="/nextresults"
		type="net.spy.photo.struts.CursorAction"
		scope="request"
		name="cursorForm">
		<forward name="success" path="/results.jsp" />
	</action>

	<!-- Search result cursor movement -->
	<action    path="/listcomments"
		type="net.spy.photo.struts.ListCommentsAction">
		<forward name="success" path="/nextcomments.do" />
	</action>

	<!-- Search result cursor movement -->
	<action    path="/nextcomments"
		type="net.spy.photo.struts.CursorAction"
		scope="request"
		name="cursorForm">
		<forward name="success" path="/comments.jsp" />
	</action>

	<!-- Search result filtering -->
	<action path="/filterSearch"
		type="net.spy.photo.struts.SearchFilterAction"
		name="searchForm">
		<forward name="success" path="/nextresults.do"/>
		<forward name="showResults" path="/refreshDisplay.do?search_id=0" />
	</action>

	<!-- Image uploads -->
	<action path="/upload"
		type="net.spy.photo.struts.UploadAction"
		input="/addform.jsp"
		name="uploadForm">
		<forward name="success" path="/addform.jsp" />
	</action>

	<!-- Saving a search. -->
	<action path="/savesearch"
		type="net.spy.photo.struts.SaveSearchAction"
		scope="request"
		name="saveSearchForm">
		<forward name="success" path="/savedsearch.jsp"/>
	</action>

	<!-- New user self-creation -->
	<action    path="/newuser"
		type="net.spy.photo.struts.NewUserAction"
		input="/newuserform.jsp"
		scope="request"
		name="newUserForm">
		<forward name="success" path="/index.jsp" />
	</action>

	<!-- Add a new image to a gallery -->
	<action path="/addToGallery"
		type="net.spy.photo.struts.AddToGalleryAction"
		scope="request"
		name="addToGalleryForm">
		<forward name="success" path="/display.do" />
	</action>

	<!-- Save a gallery -->
	<action path="/saveGallery"
		type="net.spy.photo.struts.SaveGalleryAction"
		input="/savegallery.jsp"
		scope="request"
		name="saveGalleryForm">
		<forward name="success" path="/index.jsp" />
	</action>

	<!-- ***************************************************************** -->
	<!-- Admin stuff -->
	<!-- ***************************************************************** -->

	<!-- Managing users -->
	<action path="/admuseredit"
		name="adminUserForm"
		input="/admin/users.jsp"
		type="net.spy.photo.struts.AdminSelectUserAction">
		<forward name="success" path="/admin/edituser.jsp" />
	</action>

	<action path="/admusersave"
		name="adminUserForm"
		input="/admin/edituser.jsp"
		type="net.spy.photo.struts.AdminSaveUserAction">
		<forward name="success" path="/admin/users.jsp" />
	</action>

	<!-- Managing categories -->
	<action path="/admcatedit"
		name="adminCatForm"
		input="/admin/categories.jsp"
		type="net.spy.photo.struts.AdminSelectCatAction">
		<forward name="success" path="/admin/editcat.jsp" />
	</action>

	<action path="/admcatsave"
		name="adminCatForm"
		input="/admin/editcat.jsp"
		type="net.spy.photo.struts.AdminSaveCatAction">
		<forward name="success" path="/admin/categories.jsp" />
	</action>

	<!-- Creating a profile -->
	<action path="/admnewprofile"
		name="adminNewProfileForm"
		input="/admin/newprofile.jsp"
		type="net.spy.photo.struts.AdminSaveProfile">
		<forward name="success" path="/admin/newprofile.jsp" />
	</action>

	<!-- Modify an image's data -->
	<action path="/admeditimage"
		name="uploadForm"
		input="/admin/display.jsp"
		type="net.spy.photo.struts.AdminEditImage">
		<forward name="success" path="/display.do"/>
	</action>

	<action path="/admin/saveProperties"
		name="emptyForm"
		input="/admin/properties.jsp"
		type="net.spy.photo.struts.AdminSaveProperties">
		<forward name="success" path="/index.jsp"/>
	</action>

	<!-- REPORTING -->

	<action path="/report/userCat"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="User Category Report"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.GetUserCat"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<action path="/report/userCatXd"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="User Category Report"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.GetUserCatXd"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<action path="/report/userImgs"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="User Image View Report"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.GetImagesSeenByUser"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<action path="/report/topImages"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="Top Images"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.MostViewedImages"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<action path="/report/topImagesXd"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="Top Images"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.MostViewedImagesXd"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<action path="/report/mostActiveUsers"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="Most Active Users"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.MostActiveUsers"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<action path="/report/mostActiveUsersXd"
		className="net.spy.photo.struts.AdminReportMapping"
		type="net.spy.photo.struts.AdminReportAction">

		<set-property property="reportName" value="Most Active Users"/>
		<set-property property="spt"
			value="net.spy.photo.sp.reporting.MostActiveUsersXd"/>

		<forward name="success" path="/admin/reportDisplay.jsp"/>
	</action>

	<!-- End of reporting -->

  </action-mappings>

	<message-resources parameter="net.spy.photo.photoresources"/>

	<plug-in className="org.apache.struts.validator.ValidatorPlugIn" >
		<set-property
			property="pathnames"
			value="/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml"/>
	</plug-in>

</struts-config>
